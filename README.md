# MTA-LSTM in TensorFlow

TensorFlow implementation of paper [Topic-to-Essay Generation with Neural Networks](http://ir.hit.edu.cn/~xcfeng/xiaocheng%20Feng's%20Homepage_files/final-topic-essay-generation.pdf).

## Motivation: 

The origin [implementation](https://github.com/hit-computer/MTA-LSTM) only provides the MTA-LSTM model, and the code is out-of-date.
In this repo, all three models in the paper are implemented in TensorFlow. And the latest TensorFlow seq2seq and RNNWrapper apis are utilized to make the code clean. 

**If you find this repo is helpful, a star would be so nice!**

## Prerequisites
- Python3
- TensorFlow >= 1.7

## Implementation Notes
1. TAV-LSTM: feed topic embedding average to a forward network to obtain initial state of decoder.
2. TAT-LSTM: at each time step, compute attention on the topic embedding using Bahdanau Attention, and concat with input to the decoder.
3. MTA-LSTM: maintain a **coverage vector** to record the whether topic information has been expressed during the training.

**Note**: beam search used in the origin repo is **NOT SUPPORTED**.

You can refer to the code for more details. If you meet any problems, feel free to raise a issue. 

For the data preprocessing, you may refer to the origin paper and process your own data.



## Generated Examples
Below are some examples  generated by three models (in Chinese):

---

Topic words:  留学 职业规划

TAV-LSTM: 现在 在 一 家 国企 上班 ， 离家 太 远 的 样子 ， 所以 我 想 去 云南 ， 想 去 一 家 公司 工作 ， 但是 我 想 去 外地 工作 ， 我 想 去 大 城市 发展 ， 但是 父母 供 我 见识 ， 我 应该 怎么 做 ？ 人 的 宝宝 应该 怎么 办 ？

TAT-LSTM: 本人 是 211 大学 的 大二 学生 ， 现在 在 湖北 ， 学校 是 五年制 ， 在 湖北 ， 英语 还 行 ， 想 去 学 些 什么 ， 不 想 从事 会计 方面 ， 想 转 专业 的 ， 希望 能 从事 高 学历 的 ， 但是 不 知道 该 做 些 什么 ？ 需要 具备 哪些 方面 的 工作 ？ 是 不 是 也 就 是 这样 的 ， 的 话 ， 应该 如何 选择 ？ 大学 毕业生 ， 在 做 什么 准备 的 ，

MTA-LSTM: 我 是 一 名 大三 的 学生 ， 今年 九月 去 德国 读 金融 硕士 ， 现在 想 出国 读研 ， 但是 我 觉得 自己 不 喜欢 这个 专业 ， 想 问问 各位 前辈 们 ， 澳洲 的 学校 和 澳洲 的 教育 学校 有 哪些 差距 ？ 我 想 去 那里 发展 ， 但是 我 真的 很 迷茫 ， 我 不 知道 该 怎么 选择 。 。 的 话 我 应该 选择 什么 专业 呢 ？ 大学 大学 读书 梦想 我 该 如何 选择 ？ 感激 

---

Topic words: 爱情 恋爱

TAV-LSTM: 我 和 她 是 异地 恋 ， 她 很 喜欢 她 ， 我 很 想 她 和 她 在 一起 ， 我 想 留住 她 ， 但是 又 不 会 主动 找 她 聊天 ， 她 说 我 是 不 是 很 好 ， 但 我 真的 很 想 分手 。 他 却 不 愿意 和 他 做 朋友 ， 我 该 怎么 办 ？

TAT-LSTM:  我 的 女友 是 个 女 的 ， 我 是 个 男生 ， 他 的 我 是 一个 处女 ， 他 也 是 一个 很 好 的 女 的 。 他 有时 我 问 他 要 怎么 做 ， 后来 他 又 说 他 不 爱 我 ， 然后 他 就 分手 了 。 和好 后 我 却 很 想 跟 他 分开 。 我 也 不 知道 我 的 心意 ， 不 会 再 联系 。 我 说 他 不 是 分手 。 我 是 不 是 和 他 吵架 ？ ， 我 该 怎么 办 ？

MTA-LSTM: 我 是 一个 宅男 ， 我 是 一个 男生 ， 其次 是 因为 我 对 她 很 好 ， 我 也 很 喜欢 他 ， 但是 她 不 主动 给 我 说 ， 我 就 不 想 跟 她 说 了 ， 我 该 怎么 办 ？ 她 说 我 不 喜欢 她 ， 我 该 怎么 办 ？ 她 说 我 不 喜欢 她 ， 我 该 怎么 办 ？ 她 说 我 不 喜欢 她 ， 我 该 怎么 办 ？ 她 说 我 不 喜欢 她 ， 我 该 怎么 办 ？